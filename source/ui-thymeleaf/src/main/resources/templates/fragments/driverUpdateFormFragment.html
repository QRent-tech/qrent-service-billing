<div th:fragment="assembledForm">
    <div th:replace="fragments/commonFormFragment.html :: commonForm(
            title='Update a Driver',
            closeRef='/drivers',
            content=~{fragments/driverUpdateFormFragment.html :: updateForm},
            request=${updateRequest}
        )">
    </div>
</div>
<div th:fragment="updateForm">
    <div th:replace="fragments/driverCommonFormFragment :: onClickRequiredObligationScript"></div>
    <div th:replace="fragments/driverCommonFormFragment :: onClickLegalEntityTypeScript"></div>
    <script>
        function onChangeContractData() {
            const contractUpdateWarning = document.getElementById("contractUpdateWarningId");
            contractUpdateWarning.hidden = false;
        }
    </script>
    <div id="contractUpdateWarningId"
         hidden
         class="mt-3 mb-3">
        <ul class="list-group">
            <li class="list-group-item list-group-item-danger fs-6">Dear User, please be aware that Driver's Contract
                will be updated!
            </li>
        </ul>
    </div>
    <form
            th:action="@{/drivers/update}"
            th:object="${updateRequest}"
            method="post">
        <input id="driverId" required
               th:field="*{id}"
               type="text"
               hidden/>
        <p class="fs-5">Setup:</p>
        <div class="row">
            <div class="mb-3">
                <label class="form-label text-muted"
                       for="recommendedByDriverId">Recommended by:</label>
                <select id="recommendedByDriverId"
                        class="form-select"
                        th:field="*{recommendedByDriverId}">
                    <option th:value="null">No recommendation</option>
                    <option th:each="driver : ${recommendedByOptions}"
                            th:value="${driver.id}"
                            th:text="|${driver.lastName} ${driver.firstName}, isikukood: ${driver.isikukood}|">??
                    </option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="activeId"
                           th:field="*{active}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="activeId">Activated</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="needFeeId"
                           th:field="*{needFee}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="needFeeId">Need Fee</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-label text-muted"
                           for="callSignId">New Call Sign</label>
                    <select id="callSignId"
                            class="form-select"
                            th:field="*{callSignId}">
                        <option th:value="null">No Call Sign</option>
                        <option th:each="callSign : ${callSigns}"
                                th:value="${callSign.id}"
                                th:text="${callSign.callSign}">??
                        </option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="hasRequiredObligationId"
                           th:field="*{hasRequiredObligation}"
                           onchange="onClickRequiredObligation()"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="hasRequiredObligationId">Need Required
                        Obligation</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-label text-muted" for="requiredObligationId">Required Obligation, EUR</label>
                    <input class="form-control" id="requiredObligationId" placeholder="Enter Required Obligation, EUR"
                           th:field="*{requiredObligation}"
                           th:disabled="${updateRequest.hasRequiredObligation == false}"
                           type="number"/>
                </div>
            </div>
        </div>
        <p class="fs-5">Q-info:</p>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <label class="form-label text-muted"
                           for="qFirmId">Select Q-Firm</label>
                    <select id="qFirmId"
                            class="form-select"
                            onchange="onChangeContractData()"
                            th:field="*{qFirmId}">
                        <option th:each="qFirm : ${qFirms}"
                                th:value="${qFirm.id}"
                                th:text="${qFirm.name}"></option>
                    </select>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-label text-muted" for="deposit">Deposit</label>
                    <input class="form-control" id="deposit" placeholder="Enter Deposit -EUR"
                           th:field="*{deposit}"
                           type="number"/>
                </div>
            </div>
        </div>
        <p class="fs-5">Drivers info:</p>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="firstName">First Name</label>
                    <input class="form-control" id="firstName" placeholder="Enter First Name" required
                           th:field="*{firstName}"
                           onchange="onChangeContractData()"
                           type="text"/>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="lastName">Last Name</label>
                    <input class="form-control" id="lastName" placeholder="Enter Last Name" required
                           th:field="*{lastName}"
                           onchange="onChangeContractData()"
                           type="text"/>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="taxNumber">Isikukood</label>
                    <input class="form-control" id="taxNumber" placeholder="Enter tax number" required
                           th:field="*{taxNumber}"
                           onchange="onChangeContractData()"
                           type="number"/>
                </div>
            </div>
        </div>
        <div class="mb-3">
            <label class="form-check-label text-muted" for="address">Address</label>
            <input class="form-control" id="address" placeholder="Enter Address"
                   required
                   th:field="*{address}"
                   onchange="onChangeContractData()"
                   type="text"/>
        </div>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="driverLicenseNumber">License Number</label>
                    <input class="form-control" id="driverLicenseNumber"
                           placeholder="Enter License Number"
                           required
                           th:field="*{driverLicenseNumber}"
                           onchange="onChangeContractData()"
                           type="text"/>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="driverLicenseExp">License Expiration date</label>
                    <input class="form-control" id="driverLicenseExp"
                           placeholder="Enter License Exp"
                           required
                           th:field="*{driverLicenseExp}"
                           type="date"/>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="taxiLicense">Taxi License </label>
                    <input class="form-control" id="taxiLicense"
                           placeholder="Enter Taxi License"
                           th:field="*{taxiLicense}"
                           type="text"/>
                </div>
            </div>
        </div>
        <p class="fs-5">Drivers contact info:</p>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="phone">Phone</label>
                    <input class="form-control" id="phone" placeholder="Enter Phone" required
                           th:field="*{phone}"
                           onchange="onChangeContractData()"
                           type="text"/>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <label class="form-check-label text-muted" for="email">E-mail</label>
                    <input class="form-control" id="email" placeholder="Enter E-mail" required
                           th:field="*{email}"
                           onchange="onChangeContractData()"
                           type="email"/>
                </div>
            </div>
        </div>
        <div class="mb-3">
            <input class="form-check-input" id="needInvoicesByEmailId"
                   th:field="*{needInvoicesByEmail}"
                   type="checkbox"/>
            <label class="form-check-label text-muted" for="needInvoicesByEmailId">Need invoices by
                email</label>
        </div>
        <p class="fs-5">Drivers communication type:</p>
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="byTelegramId"
                           th:field="*{byTelegram}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byTelegramId">Telegram</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="byWhatsAppId"
                           th:field="*{byWhatsApp}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byWhatsAppId">WhatsApp</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="byViberId"
                           th:field="*{byViber}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byViberId">Viber</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="byEmailId"
                           th:field="*{byEmail}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byViberId">Email</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="bySmsId"
                           th:field="*{bySms}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byViberId">Sms</label>
                </div>
            </div>
            <div class="col">
                <div class="mb-3">
                    <input class="form-check-input" id="byPhoneId"
                           th:field="*{byPhone}"
                           type="checkbox"/>
                    <label class="form-check-label text-muted" for="byViberId">Phone</label>
                </div>
            </div>
        </div>
        <p class="fs-5">Drivers Legal entity:</p>
        <div class="row mb-3">
            <div class="col">
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="legalEntityTypeOptions" id="self_employed_id"
                           onclick="onClickLegalEntityType(this)" value="SELF_EMPLOYED"
                           th:field="*{legalEntityType}">
                    <label class="form-check-label text-muted" for="self_employed_id">Self employed</label>
                </div>
            </div>
            <div class="col">
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="legalEntityTypeOptions" id="lhv_account_id"
                           onclick="onClickLegalEntityType(this)" value="LHV_ACCOUNT" th:field="*{legalEntityType}">
                    <label class="form-check-label text-muted" for="lhv_account_id">LHV Bank account</label>
                </div>
            </div>
            <div class="col">
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="legalEntityTypeOptions" id="company_id"
                           onclick="onClickLegalEntityType(this)" value="COMPANY" th:field="*{legalEntityType}">
                    <label class="form-check-label text-muted" for="company_id">Company</label>
                </div>
            </div>
        </div>
        <div id="lhv_account_form_id" style="display: none">
            <div class="row">
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="lhvAccount">LHV Account:</label>
                        <input class="form-control" id="lhvAccount" placeholder="Enter LHV Account"
                               th:field="*{lhvAccount}"
                               type="text"/>
                    </div>
                </div>
            </div>
        </div>
        <div id="company_form_id" style="display: none">
            <div class="row">
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="companyName">Company name</label>
                        <input class="form-control" id="companyName" placeholder="Enter Company name"
                               th:field="*{companyName}"
                               onchange="onChangeContractData()"
                               type="text"/>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="regNumber">Registration Number</label>
                        <input class="form-control" id="regNumber" placeholder="Enter Registration Number"
                               th:field="*{regNumber}"
                               onchange="onChangeContractData()"
                               type="text"/>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="companyVat">VAT</label>
                        <input class="form-control" id="companyVat" placeholder="Enter VAT"
                               th:field="*{companyVat}"
                               onchange="onChangeContractData()"
                               type="text"/>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="companyCeoFirstName">CEO first name</label>
                        <input class="form-control" id="companyCeoFirstName" placeholder="Enter first name"
                               th:field="*{companyCeoFirstName}"
                               onchange="onChangeContractData()"
                               type="text"/>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="companyCeoLastName">CEO last name</label>
                        <input class="form-control" id="companyCeoLastName" placeholder="Enter last name"
                               th:field="*{companyCeoLastName}"
                               onchange="onChangeContractData()"
                               type="text"/>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label class="form-check-label text-muted" for="companyCeoTaxNumber">CEO isikukood</label>
                        <input class="form-control" id="companyCeoTaxNumber" placeholder="Enter tax number"
                               th:field="*{companyCeoTaxNumber}"
                               onchange="onChangeContractData()"
                               type="number"/>
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-check-label text-muted" for="companyAddress">Address</label>
                <input class="form-control" id="companyAddress" placeholder="Enter Address"
                       th:field="*{companyAddress}"
                       onchange="onChangeContractData()"
                       type="text"/>
            </div>
        </div>

        <div class="form-group">
            <div class="mb-3">
                <label class="form-label text-muted" for="commentId">Comment</label>
                <textarea class="form-control"
                          id="commentId"
                          placeholder="Enter Comment"
                          th:field="*{comment}"/>
            </div>
        </div>
        <div th:replace="fragments/addUpdateFormButtonsFragment.html :: addUpdateButtons(
            submitValue='Update',
            cancelHref='/drivers'
        )">
        </div>
    </form>
</div>
